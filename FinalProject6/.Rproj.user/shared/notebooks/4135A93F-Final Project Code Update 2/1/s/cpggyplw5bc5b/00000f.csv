"0","  # Loss function: Negative log-likelihood"
"0","  loss_function <- function(beta, x, y){"
"0","    "
"0","    p <- 1 / (1 + exp(-x %*% beta))"
"0","    "
"0","    # Check if any p is exactly 0 or 1, which would cause log(0) or log(1) errors"
"0","    "
"0","    if (any(p == 0 | p == 1)) {"
"0","      epsilon <- 1e-15"
"0","      p <- pmax(pmin(p, 1 - epsilon), epsilon)"
"0","      "
"0","      # Notify the user if epsilon was applied"
"0","      if (!epsilon_applied) {"
"0","        warning(""Log(0) or Log(1) encountered. Epsilon was applied to probabilities to avoid numerical errors."")"
"0","        epsilon_applied <<- TRUE"
"0","        }"
"0","    }"
"0","    "
"0","    # Negative log-likelihood"
"0","    log_likelihood <- -sum(y * log(p) + (1 - y) * log(1 - p))"
"0","    "
"0","    return(log_likelihood)"
"0","  }"
